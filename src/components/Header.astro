---
import { SITE } from "../config";
import ThemeToggle from "./ThemeToggle.astro";

const navItems = [
    { href: "/sobre-mi", label: "Sobre Mí" },
    { href: "/blog", label: "Blog" },
    { href: "/galeria", label: "Galería" },
    { href: "/contacto", label: "Contacto" },
];
---

<header
    class="w-full max-w-3xl mx-auto py-8 px-6 flex items-center justify-between"
>
    <a
        href="/"
        class="site-title text-2xl font-bold font-heading transition-colors"
    >
        {SITE.title}
    </a>

    <!-- Navegación de escritorio -->
    <nav class="hidden md:flex items-center gap-6">
        {
            navItems.map((item) => (
                <a href={item.href} class="nav-link text-lg font-medium">
                    {item.label}
                </a>
            ))
        }
    </nav>

    <div class="flex items-center gap-2">
        <ThemeToggle />

        <!-- Botón de menú móvil -->
        <button
            id="mobile-menu-btn"
            class="md:hidden p-2 rounded-lg hover:bg-black/5 dark:hover:bg-white/5 transition-colors"
            aria-label="Abrir menú"
            aria-expanded="false"
        >
            <svg
                class="w-6 h-6"
                style="color: var(--ui-nav-link);"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
        </button>
    </div>
</header>

<!-- Menú lateral móvil -->
<div
    id="mobile-menu-overlay"
    class="fixed inset-0 bg-black/50 z-40 hidden opacity-0 transition-opacity duration-300"
    aria-hidden="true"
>
</div>

<nav
    id="mobile-menu"
    class="fixed top-0 right-0 h-full w-64 z-50 transform translate-x-full transition-transform duration-300 shadow-xl"
    style="background-color: var(--color-background);"
    aria-label="Menú de navegación móvil"
>
    <div
        class="flex items-center justify-between p-6 border-b"
        style="border-color: var(--color-border);"
    >
        <span
            class="font-bold font-heading text-lg"
            style="color: var(--color-text);">Menú</span
        >
        <button
            id="mobile-menu-close"
            class="p-2 rounded-lg hover:bg-black/5 dark:hover:bg-white/5 transition-colors"
            aria-label="Cerrar menú"
        >
            <svg
                class="w-6 h-6"
                style="color: var(--ui-nav-link);"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>
    </div>

    <div class="p-6 flex flex-col gap-4">
        {
            navItems.map((item) => (
                <a
                    href={item.href}
                    class="mobile-nav-link text-lg font-medium py-2 px-3 rounded-lg hover:bg-black/5 dark:hover:bg-white/5 transition-colors"
                    style="color: var(--ui-nav-link);"
                >
                    {item.label}
                </a>
            ))
        }
    </div>
</nav>

<script>
    const menuBtn = document.getElementById("mobile-menu-btn");
    const menuClose = document.getElementById("mobile-menu-close");
    const menu = document.getElementById("mobile-menu");
    const overlay = document.getElementById("mobile-menu-overlay");

    function openMenu() {
        menu?.classList.remove("translate-x-full");
        overlay?.classList.remove("hidden");
        setTimeout(() => overlay?.classList.remove("opacity-0"), 10);
        menuBtn?.setAttribute("aria-expanded", "true");
        document.body.style.overflow = "hidden";
    }

    function closeMenu() {
        menu?.classList.add("translate-x-full");
        overlay?.classList.add("opacity-0");
        setTimeout(() => overlay?.classList.add("hidden"), 300);
        menuBtn?.setAttribute("aria-expanded", "false");
        document.body.style.overflow = "";
    }

    menuBtn?.addEventListener("click", openMenu);
    menuClose?.addEventListener("click", closeMenu);
    overlay?.addEventListener("click", closeMenu);

    // Cerrar con tecla Escape
    document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") closeMenu();
    });
</script>
